import { useState } from "react";
import { uid } from "./Uid.mdx";
import { isEqualSet } from "./IsEqualSet.mdx";
import { Checkbox } from "./Checkbox.mdx";
import { VerifyButton } from "./VerifyButton.mdx";
import { Feedback } from "./Feedback.mdx";

export const ObjectiveQuiz = ({options, answer}) => {
  const [feedback, setFeedback] = useState(null);
  const [checkedList, setCheckedList] = useState(new Set());
  const handleCheckedList = ({value, checked}) => {
    if (checked) checkedList.add(value)
    else checkedList.delete(value)
    setCheckedList(checkedList);
  };
  const checkExercise = () => {
    if (checkedList.size === 0) {
      alert(`답을 선택하세요`);
      return;
    }
    const correct = new Set(Array.isArray(answer) ? answer : [String(answer)]);
    setFeedback(isEqualSet(correct, checkedList));
  };
  return (
    <>
      <div className="answer">
        {options.map((option, index) => (
          <Checkbox
            key={index}
            option={option}
            setCheckedList={handleCheckedList}
          />
        ))}
      </div>
      <VerifyButton checkExercise={checkExercise} feedback={feedback}  />
      <Feedback feedback={feedback}>
        블라블라
      </Feedback>
    </>
  );
};
